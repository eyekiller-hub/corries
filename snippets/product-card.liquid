{% include 'attribute-product-tag-badge' %}

{% assign image_lazy = _image_lazy %}

{% assign variant = product.first_available_variant | default: product.variants[0] %}

{% assign url = product.url | within: collection %}

{% assign image_url = product.images[0] | img_url: '600x' %}

{% assign image_alt = product.images[0].alt | escape %}

{% assign image_box_ratio = '100%' %}

{% assign image_attributes = ' ' %}

{% if image_lazy %}
  {% assign image_attributes = 'data-lazy' %}
{% endif %}

{% assign title = product.title %}

{% assign price_class = ' ' %}

{% if product.compare_at_price_min > product.price_min %}
  {% assign price_class = 'text-color-red' %}
{% endif %}

{% assign price_min = product.price_min | money %}

{% assign compare_at_price_min_class = ' ' %}

{% if product.compare_at_price_min < product.price_min %}
  {% assign compare_at_price_min_class = 'hide' %}
{% endif %}

{% assign compare_at_price_min = product.compare_at_price_min | money %}

{% assign from = ' ' %}

{% if product.price_varies %}
  {% assign from = 'products.product.from' | t %}
{% endif %}

{% assign copy = ' ' %}

{% assign copy_class = 'hide' %}

{% if product.metafields.card.copy %}
  {% assign copy = from | append: ' ' | append: product.metafields.card.copy %}

  {% assign copy_class = ' ' %}
{% endif %}

{% assign product_json = product | json %}

{% assign first_available_variant_id = variant.id %}

{% assign submit_attributes = ' ' %}

{% unless variant.available %}
  {% assign submit_attributes = 'disabled' %}
{% endunless %}

{% assign product_id = product.id %}

{% assign submit_html = 'products.product.add_to_cart' | t %}

{% unless variant.available %}
  {% assign submit_html = 'products.product.sold_out' | t %}
{% endunless %}

{% assign promo_badge_copy = ' ' %}

{% assign promo_badge_class = 'hide' %}

{% if product.metafields.promo_badge.copy %}
  {% assign promo_badge_copy = product.metafields.promo_badge.copy %}

  {% assign promo_badge_class = ' ' %}
{% endif %}

{% assign tag_badge_html = ' ' %}

{% assign tag_badge_class = 'hide' %}

{% if product_tag_badge %}
  {% assign tag_badge_html = '<img data-src="' | append: product_tag_badge_image_url | append: '" alt="' | append: product_tag_badge_image_alt | append: '" />' %}

  {% assign tag_badge_class = ' ' %}
{% endif %}

{%
  include 'product-card-template',
  _url: url,
  _image_url: image_url,
  _image_alt: image_alt,
  _image_box_ratio: image_box_ratio,
  _image_attributes: image_attributes,
  _title: title,
  _price_class: price_class,
  _price_min: price_min,
  _compare_at_price_min_class: compare_at_price_min_class,
  _compare_at_price_min: compare_at_price_min,
  _copy: copy,
  _from: from,
  _product_json: product_json,
  _first_available_variant_id: first_available_variant_id,
  _submit_attributes: submit_attributes,
  _product_id: product_id,
  _submit_html: submit_html,
  _promo_badge_copy: promo_badge_copy,
  _promo_badge_class: promo_badge_class,
  _tag_badge_html: tag_badge_html,
  _tag_badge_class: tag_badge_class
%}
